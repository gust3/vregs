<?php// Запрет прямого доступа.defined('_JEXEC') or die; // Подключаем библиотеку modellist Joomla.jimport('joomla.application.component.modellist'); /** * Модель списка сообщений компонента HelloWorld. */class gustVMtoolsModelNets extends JModelList{    /**     * Метод для построения SQL запроса для загрузки списка данных.     *     * @return string SQL запрос.     */	 	public function __construct($config = array())	 {	 if (empty($config['filter_fields'])) {	 $config['filter_fields'] = array(	 'id', 'ymname', 'label', 'email', 'phone', 'published', 'url', 'dostavka'	 );	 }	 	 parent::__construct($config);	 }	protected function getListQuery()    {        // Создаем новый query объект.		$orderCol	= $this->state->get('list.ordering');		$orderDirn	= $this->state->get('list.direction');        $db = JFactory::getDBO();        $query = $db->getQuery(true);        $query->select('*');        $query->from('#__vmtools_netshop');		$query->order($db->getEscaped($orderCol.' '.$orderDirn));		        return $query;    }	public function unpublish($arr)	{				$db = JFactory::getDBO();		foreach ($arr as $key=>$val)		{			$query = 'UPDATE #__vmtools_netshop SET published = 0 WHERE id='.$val;			$db->setQuery($query);			$db->query();		}			}	public function delete_net($arr)	{				$db = JFactory::getDBO();		foreach ($arr as $key=>$val)		{			$query = 'DELETE FROM #__vmtools_netshop WHERE id ='.$val;			$db->setQuery($query);			$db->query();		}	}	public function publish($arr)	{				$db = JFactory::getDBO();		foreach ($arr as $key=>$val)		{			$query = 'UPDATE #__vmtools_netshop SET published = 1 WHERE id='.$val;			$db->setQuery($query);			$db->query();		}			}		public function changenames()	{		$db = JFactory::getDBO();		$query = 'SELECT id, ymname FROM #__vmtools_netshop';		$db->setQuery($query);		$nets = $db->loadObjectList();					foreach ($nets as $net)		{			$word = str_replace('.Ru', "", str_replace('www', '', str_replace('.RU', '', str_replace('.Net', '', str_replace('.org', '', str_replace("'", "", str_replace('.net', '', str_replace('.com', '', str_replace('.ru', '', $net->ymname)))))))));			$query = 'UPDATE #__vmtools_netshop SET label = "'.$db->Quote($word).'" WHERE id = '.$net->id;			$db->setQuery($query);			$db->query();			}	}		protected function populateState($ordering = null, $direction = null)	{		parent::populateState('id', 'asc');	}}